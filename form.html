<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mate â€“ Profilo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  </head>
  <body class="bg-gray-50 text-gray-900" style="font-family: 'Inter', sans-serif;">
    <header class="flex justify-between items-center px-6 py-4 shadow-sm fixed top-0 left-0 right-0 bg-white z-50">
      <div class="text-xl font-bold text-blue-600">Mate</div>
      <nav class="hidden md:flex space-x-6">
        <a href="index.html#features" class="hover:text-blue-600">Features</a>
        <a href="index.html#about" class="hover:text-blue-600">About</a>
        <a href="index.html#how" class="hover:text-blue-600">How It Works</a>
        <a href="index.html#support" class="hover:text-blue-600">Support</a>
      </nav>
      <a href="index.html" class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-5 py-2 rounded-lg shadow-lg hover:from-blue-700 hover:to-indigo-700 transform hover:scale-105 transition">Home</a>
    </header>

    <section class="pt-32 pb-16 px-6 min-h-screen">
      <div class="max-w-md mx-auto bg-white p-6 rounded-xl shadow-lg">
        <div class="mb-6">
          <div class="flex justify-between items-center mb-2 text-sm text-gray-600">
            <span id="stepText">Step 1 di 8</span>
            <span id="stepPercent">0%</span>
          </div>
          <div class="h-2 bg-gray-200 rounded">
            <div id="progressBar" class="h-2 bg-blue-600 rounded transition-all" style="width:0%"></div>
          </div>
        </div>
        <form id="multiStepForm" class="space-y-6">
          <!-- Step 1 -->
          <div class="step space-y-4">
            <label class="block">
              <span class="text-gray-700">Come ti chiami?</span>
              <input id="nome" type="text" class="mt-1 block w-full border-gray-300 rounded-md" />
            </label>
            <div class="flex justify-end">
              <button type="button" class="next-btn bg-blue-600 text-white px-4 py-2 rounded">Avanti</button>
            </div>
          </div>
          <!-- Step 2 -->
          <div class="step space-y-4 hidden">
            <label class="block">
              <span class="text-gray-700">Quanto sei ordinato?</span>
              <div class="flex items-center gap-2 mt-2">
                <span>ðŸ˜…</span>
                <input id="ordine" type="range" min="0" max="10" value="5" class="flex-1" />
                <span>ðŸ§¼</span>
              </div>
              <p class="text-sm text-gray-600 mt-1">Valore: <span id="ordineVal">5</span></p>
            </label>
            <div class="flex justify-between">
              <button type="button" class="prev-btn text-gray-600 px-4 py-2">Indietro</button>
              <button type="button" class="next-btn bg-blue-600 text-white px-4 py-2 rounded">Avanti</button>
            </div>
          </div>
          <!-- Step 3 -->
          <div class="step space-y-4 hidden">
            <span class="text-gray-700">Ti alzi presto o tardi?</span>
            <div class="flex flex-col sm:flex-row gap-4">
              <button type="button" data-value="Mattiniero" class="option-btn flex-1 bg-gray-100 py-3 rounded hover:bg-blue-50">ðŸŒž Mattiniero</button>
              <button type="button" data-value="Notturno" class="option-btn flex-1 bg-gray-100 py-3 rounded hover:bg-blue-50">ðŸŒ™ Notturno</button>
            </div>
            <div class="flex justify-between">
              <button type="button" class="prev-btn text-gray-600 px-4 py-2">Indietro</button>
              <button type="button" class="next-btn bg-blue-600 text-white px-4 py-2 rounded" disabled>Avanti</button>
            </div>
          </div>
          <!-- Step 4 -->
          <div class="step space-y-4 hidden">
            <span class="text-gray-700">Quali sono i tuoi hobby?</span>
            <div id="hobbyWrapper" class="flex flex-wrap gap-2"></div>
            <div class="flex justify-between">
              <button type="button" class="prev-btn text-gray-600 px-4 py-2">Indietro</button>
              <button type="button" class="next-btn bg-blue-600 text-white px-4 py-2 rounded">Avanti</button>
            </div>
          </div>
          <!-- Step 5 -->
          <div class="step space-y-4 hidden">
            <label class="block">
              <span class="text-gray-700">Scrivi una breve descrizione di te</span>
              <textarea id="descrizione" rows="4" maxlength="150" class="mt-1 block w-full border-gray-300 rounded-md"></textarea>
              <p class="text-sm text-gray-600 mt-1"><span id="charCount">0</span>/150</p>
            </label>
            <div class="flex justify-between">
              <button type="button" class="prev-btn text-gray-600 px-4 py-2">Indietro</button>
              <button type="button" class="next-btn bg-blue-600 text-white px-4 py-2 rounded">Avanti</button>
            </div>
          </div>
          <!-- Step 6 -->
          <div class="step space-y-4 hidden">
            <span class="text-gray-700">Che tipo di coinquilino cerchi?</span>
            <label class="flex items-center gap-2">
              <input type="checkbox" value="eta" class="pref" />
              <span>EtÃ  simile</span>
            </label>
            <label class="flex items-center gap-2">
              <input type="checkbox" value="genere" class="pref" />
              <span>Stesso genere</span>
            </label>
            <label class="flex items-center gap-2">
              <input type="checkbox" value="abitudini" class="pref" />
              <span>Abitudini simili</span>
            </label>
            <div class="flex justify-between">
              <button type="button" class="prev-btn text-gray-600 px-4 py-2">Indietro</button>
              <button type="button" class="next-btn bg-blue-600 text-white px-4 py-2 rounded">Avanti</button>
            </div>
          </div>
          <!-- Step 7 -->
          <div class="step space-y-4 hidden">
            <span class="text-gray-700">Scegli il profilo che preferisci</span>
            <div class="flex flex-col sm:flex-row gap-4">
              <div class="profile-card flex-1 border rounded-lg shadow p-4 text-center hover:shadow-md">
                <img src="https://randomuser.me/api/portraits/men/10.jpg" alt="Marco" class="w-24 h-24 mx-auto rounded-full mb-2" />
                <h4 class="font-semibold">Marco</h4>
                <p class="text-xs text-gray-500 mb-1">Sportivo Â· Notturno Â· Pulito</p>
                <p class="text-sm mb-3">Ama la bici e cucinare piatti tipici.</p>
                <button type="button" data-value="Marco" class="choose-btn bg-blue-600 text-white px-4 py-2 rounded">Scegli</button>
              </div>
              <div class="profile-card flex-1 border rounded-lg shadow p-4 text-center hover:shadow-md">
                <img src="https://randomuser.me/api/portraits/men/20.jpg" alt="Luca" class="w-24 h-24 mx-auto rounded-full mb-2" />
                <h4 class="font-semibold">Luca</h4>
                <p class="text-xs text-gray-500 mb-1">Calmo Â· Mattiniero Â· Ordinato</p>
                <p class="text-sm mb-3">Lettore accanito e amante delle passeggiate.</p>
                <button type="button" data-value="Luca" class="choose-btn bg-blue-600 text-white px-4 py-2 rounded">Scegli</button>
              </div>
            </div>
            <div class="flex justify-between">
              <button type="button" class="prev-btn text-gray-600 px-4 py-2">Indietro</button>
            </div>
          </div>
          <!-- Step 8 -->
          <div class="step space-y-4 hidden">
            <h3 class="text-lg font-semibold">Riepilogo</h3>
            <ul class="text-sm space-y-1" id="summary"></ul>
            <div class="flex justify-between">
              <button type="button" class="prev-btn text-gray-600 px-4 py-2">Indietro</button>
              <button type="button" id="confirmBtn" class="bg-blue-600 text-white px-4 py-2 rounded">Conferma</button>
            </div>
          </div>
        </form>
      </div>
    </section>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const steps = document.querySelectorAll('.step');
        const progressBar = document.getElementById('progressBar');
        const stepText = document.getElementById('stepText');
        const stepPercent = document.getElementById('stepPercent');
        const formData = JSON.parse(localStorage.getItem('mateForm')) || {};
        const hobbies = ['Musica','Sport','Cucina','Lettura','Gaming','Viaggi'];
        const hobbyWrapper = document.getElementById('hobbyWrapper');
        hobbies.forEach(h => {
          const btn = document.createElement('button');
          btn.type = 'button';
          btn.textContent = h;
          btn.className = 'hobby-btn px-3 py-1 rounded-full bg-gray-100 hover:bg-blue-50';
          btn.dataset.value = h;
          hobbyWrapper.appendChild(btn);
        });

        let currentStep = 0;
        showStep(currentStep);

        document.querySelectorAll('.next-btn').forEach(btn => btn.addEventListener('click', nextStep));
        document.querySelectorAll('.prev-btn').forEach(btn => btn.addEventListener('click', prevStep));
        document.querySelectorAll('.option-btn').forEach(btn => btn.addEventListener('click', selectOption));
        hobbyWrapper.addEventListener('click', toggleHobby);
        document.querySelectorAll('.choose-btn').forEach(btn => btn.addEventListener('click', () => chooseProfile(btn.dataset.value)));
        document.getElementById('ordine').addEventListener('input', e => {
          document.getElementById('ordineVal').textContent = e.target.value;
        });
        document.getElementById('descrizione').addEventListener('input', e => {
          document.getElementById('charCount').textContent = e.target.value.length;
        });
        document.getElementById('confirmBtn').addEventListener('click', finish);

        function showStep(i){
          steps.forEach((s,idx)=>{s.classList.toggle('hidden', idx!==i);});
          const percent = Math.round((i)/(steps.length-1)*100);
          progressBar.style.width = percent + '%';
          stepText.textContent = `Step ${i+1} di ${steps.length}`;
          stepPercent.textContent = percent + '%';
        }

        function nextStep(){
          saveData(currentStep);
          if(currentStep < steps.length-1){
            currentStep++;
            showStep(currentStep);
            if(currentStep === steps.length-1) updateSummary();
          }
        }

        function prevStep(){
          if(currentStep>0){
            currentStep--;
            showStep(currentStep);
          }
        }

        function saveData(step){
          switch(step){
            case 0:
              formData.nome = document.getElementById('nome').value.trim();
              break;
            case 1:
              formData.ordine = document.getElementById('ordine').value;
              break;
            case 2:
              formData.orario = document.querySelector('.option-btn.active')?.dataset.value || '';
              break;
            case 3:
              formData.hobby = Array.from(document.querySelectorAll('.hobby-btn.active')).map(b=>b.dataset.value);
              break;
            case 4:
              formData.descrizione = document.getElementById('descrizione').value.trim();
              break;
            case 5:
              formData.coinquilino = Array.from(document.querySelectorAll('.pref:checked')).map(c=>c.value);
              break;
            case 6:
              // preferito salvato con chooseProfile
              break;
          }
        }

        function selectOption(e){
          document.querySelectorAll('.option-btn').forEach(b=>b.classList.remove('bg-blue-600','text-white','active'));
          e.target.classList.add('bg-blue-600','text-white','active');
          document.querySelectorAll('.step')[2].querySelector('.next-btn').disabled = false;
        }

        function toggleHobby(e){
          if(e.target.classList.contains('hobby-btn')){
            e.target.classList.toggle('bg-blue-600');
            e.target.classList.toggle('text-white');
            e.target.classList.toggle('active');
          }
        }

        function chooseProfile(name){
          formData.preferito = name;
          localStorage.setItem('preferito', name);
          nextStep();
        }

        function updateSummary(){
          saveData(6);
          const ul = document.getElementById('summary');
          ul.innerHTML = '';
          ul.innerHTML += `<li><strong>Nome:</strong> ${formData.nome || ''}</li>`;
          ul.innerHTML += `<li><strong>Ordine:</strong> ${formData.ordine || ''}</li>`;
          ul.innerHTML += `<li><strong>Orario:</strong> ${formData.orario || ''}</li>`;
          ul.innerHTML += `<li><strong>Hobby:</strong> ${(formData.hobby||[]).join(', ')}</li>`;
          ul.innerHTML += `<li><strong>Descrizione:</strong> ${formData.descrizione || ''}</li>`;
          ul.innerHTML += `<li><strong>Preferenze:</strong> ${(formData.coinquilino||[]).join(', ')}</li>`;
          ul.innerHTML += `<li><strong>Profilo scelto:</strong> ${formData.preferito || ''}</li>`;
        }

        function finish(){
          saveData(currentStep);
          localStorage.setItem('mateForm', JSON.stringify(formData));
          alert('Dati salvati!');
          window.location.href = 'risultati.html';
        }

      });
    </script>
  </body>
</html>
